<?php
/**
 * Generated by Haxe 4.3.7
 */

namespace src;

use \php\Boot;
use \haxe\Exception;
use \sys\io\File;

class Main {
	/**
	 * @return void
	 */
	public static function main () {
		#src/Main.hx:6: lines 6-9
		if (\Sys::args()->length > 1) {
			#src/Main.hx:7: characters 13-49
			Utils::print("Usage: haxic [<file>]");
			#src/Main.hx:8: characters 13-19
			return;
		}
		#src/Main.hx:11: lines 11-23
		if (\Sys::args()->length === 1) {
			#src/Main.hx:13: characters 13-42
			$filename = (\Sys::args()->arr[0] ?? null);
			#src/Main.hx:14: characters 13-60
			$content = File::getContent($filename);
			#src/Main.hx:16: characters 13-44
			$lexer = new Lexer($content);
			#src/Main.hx:17: characters 13-43
			$tokens = $lexer->tokenize();
			#src/Main.hx:18: characters 13-45
			$parser = new Parser($tokens);
			#src/Main.hx:19: characters 13-38
			$ast = $parser->parse();
			#src/Main.hx:20: characters 13-49
			$interpreter = new Interpreter();
			#src/Main.hx:21: characters 13-35
			$interpreter->visit($ast);
			#src/Main.hx:22: characters 13-19
			return;
		}
		#src/Main.hx:26: characters 9-45
		$interpreter = new Interpreter();
		#src/Main.hx:27: lines 27-43
		while (true) {
			#src/Main.hx:29: characters 13-44
			Utils::print("haxic >> ", false);
			#src/Main.hx:30: characters 13-33
			\Sys::stdout()->flush();
			#src/Main.hx:31: characters 13-47
			$line = \Sys::stdin()->readLine();
			#src/Main.hx:32: characters 13-39
			if ($line === null) {
				#src/Main.hx:32: characters 31-39
				continue;
			}
			#src/Main.hx:34: lines 34-42
			try {
				#src/Main.hx:35: characters 17-45
				$lexer = new Lexer($line);
				#src/Main.hx:36: characters 17-47
				$tokens = $lexer->tokenize();
				#src/Main.hx:37: characters 17-49
				$parser = new Parser($tokens);
				#src/Main.hx:38: characters 17-42
				$ast = $parser->parse();
				#src/Main.hx:39: characters 17-39
				$interpreter->visit($ast);
			} catch(\Throwable $_g) {
				#src/Main.hx:40: characters 22-25
				$err = Exception::caught($_g);
				#src/Main.hx:41: characters 17-53
				Utils::print("Error: " . ($err->get_message()??'null'));
			}
		}
	}
}

Boot::registerClass(Main::class, 'src.Main');
